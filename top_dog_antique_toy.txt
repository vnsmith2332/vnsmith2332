CREATE TABLE DICE1(
	d1 INT NOT NULL);
CREATE TABLE DICE2(
	d2 INT NOT NULL);
CREATE TABLE DICE3(
	d3 INT NOT NULL);
CREATE TABLE DICE4(
	d4 INT NOT NULL);
CREATE TABLE DICE5(
	d5 INT NOT NULL);

CREATE TABLE RunningTable(
  RollNum INT IDENTITY(1,1),
  d1 INT NULL,
  d2 INT NULL,
  d3 INT NULL,
  d4 INT NULL,
  d5 INT NULL,
  SUM INT NULL,
  TOTAL INT
);

INSERT INTO DICE1
VALUES (1);
INSERT INTO DICE1
VALUES (2);
INSERT INTO DICE1
VALUES (3);
INSERT INTO DICE1
VALUES (4);
INSERT INTO DICE1
VALUES (5);
INSERT INTO DICE1
VALUES (6);

INSERT INTO DICE2
VALUES (1);
INSERT INTO DICE2
VALUES (2);
INSERT INTO DICE2
VALUES (3);
INSERT INTO DICE2
VALUES (4);
INSERT INTO DICE2
VALUES (5);
INSERT INTO DICE2
VALUES (6);

INSERT INTO DICE3
VALUES (1);
INSERT INTO DICE3
VALUES (2);
INSERT INTO DICE3
VALUES (3);
INSERT INTO DICE3
VALUES (4);
INSERT INTO DICE3
VALUES (5);
INSERT INTO DICE3
VALUES (6);

INSERT INTO DICE4
VALUES (1);
INSERT INTO DICE4
VALUES (2);
INSERT INTO DICE4
VALUES (3);
INSERT INTO DICE4
VALUES (4);
INSERT INTO DICE4
VALUES (5);
INSERT INTO DICE4
VALUES (6);

INSERT INTO DICE5
VALUES (1);
INSERT INTO DICE5
VALUES (2);
INSERT INTO DICE5
VALUES (3);
INSERT INTO DICE5
VALUES (4);
INSERT INTO DICE5
VALUES (5);
INSERT INTO DICE5
VALUES (6);

INSERT INTO RunningTable
SELECT TOP 1 d1, d2, d3, d4, d5, d1+d2+d3+d4+d5 AS [SUM],
	CASE
		WHEN d1 = d2 AND d1 = d3 AND d1 = d4 AND d1 = d5 THEN 20
		WHEN d1+d2+d3+d4+d5 = 29 THEN 15
		WHEN d1+d2+d3+d4+d5 = 28 THEN 7
		WHEN d1+d2+d3+d4+d5 = 27 THEN 5
		WHEN d1+d2+d3+d4+d5 = 26 THEN 3
		WHEN d1+d2+d3+d4+d5 = 25 THEN 3
		WHEN d1+d2+d3+d4+d5 = 14 THEN 2
		WHEN d1+d2+d3+d4+d5 = 10 THEN 2
		WHEN d1+d2+d3+d4+d5 = 9 THEN 3
		WHEN d1+d2+d3+d4+d5 = 8 THEN 4
		WHEN d1+d2+d3+d4+d5 = 7 THEN 7
		WHEN d1+d2+d3+d4+d5 = 6 THEN 15
		ELSE 0
	END AS [Total Won From Current Roll]
FROM Dice1 d1 CROSS JOIN Dice2 CROSS JOIN Dice3 CROSS JOIN Dice4 CROSS JOIN Dice5
ORDER BY NEWID();

SELECT TOP 1 RollNum, d1, d2, d3, d4, d5, Sum AS [Sum of Current roll], Total as [Points Earned on Current Roll], 
	SUM(TOTAL) OVER (ORDER BY RollNum) AS [Total Overall Score]
FROM runningtable
ORDER BY RollNUM DESC;

